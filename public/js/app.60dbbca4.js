(function(e){function t(t){for(var n,a,o=t[0],s=t[1],i=t[2],l=0,d=[];l<o.length;l++)a=o[l],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&d.push(c[a][0]),c[a]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);p&&p(t);while(d.length)d.shift()();return u.push.apply(u,i||[]),r()}function r(){for(var e,t=0;t<u.length;t++){for(var r=u[t],n=!0,a=1;a<r.length;a++){var o=r[a];0!==c[o]&&(n=!1)}n&&(u.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={app:0},c={app:0},u=[];function o(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-18c9904f":"c0d244b4","chunk-2d0c5b16":"16bac560","chunk-2d2086b7":"2aa64eba","chunk-54d21914":"122beb94","chunk-c462bbde":"84d2491e","chunk-d3f5a43c":"929087ca"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r={"chunk-18c9904f":1,"chunk-54d21914":1,"chunk-d3f5a43c":1};a[e]?t.push(a[e]):0!==a[e]&&r[e]&&t.push(a[e]=new Promise((function(t,r){for(var n="css/"+({}[e]||e)+"."+{"chunk-18c9904f":"9ad3973f","chunk-2d0c5b16":"31d6cfe0","chunk-2d2086b7":"31d6cfe0","chunk-54d21914":"74f63f15","chunk-c462bbde":"31d6cfe0","chunk-d3f5a43c":"54e10419"}[e]+".css",c=s.p+n,u=document.getElementsByTagName("link"),o=0;o<u.length;o++){var i=u[o],l=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(l===n||l===c))return t()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){i=d[o],l=i.getAttribute("data-href");if(l===n||l===c)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var n=t&&t.target&&t.target.src||c,u=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");u.code="CSS_CHUNK_LOAD_FAILED",u.request=n,delete a[e],p.parentNode.removeChild(p),r(u)},p.href=c;var h=document.getElementsByTagName("head")[0];h.appendChild(p)})).then((function(){a[e]=0})));var n=c[e];if(0!==n)if(n)t.push(n[2]);else{var u=new Promise((function(t,r){n=c[e]=[t,r]}));t.push(n[2]=u);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=o(e);var d=new Error;i=function(t){l.onerror=l.onload=null,clearTimeout(p);var r=c[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",d.name="ChunkLoadError",d.type=n,d.request=a,r[1](d)}c[e]=void 0}};var p=setTimeout((function(){i({type:"timeout",target:l})}),12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var p=l;u.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23"),a={class:"container-md app-page"},c={id:"nav",class:"mt-4"},u=Object(n["i"])(" Гости "),o=Object(n["i"])(" Смена "),s=Object(n["i"])(" Пользователи "),i=Object(n["i"])(" Вход в систему "),l=Object(n["g"])("hr",{style:{border:"1px solid black"}},null,-1),d={key:0},p=Object(n["g"])("hr",{class:"py-1"},null,-1);function h(e,t,r,h,f,m){var g=Object(n["E"])("router-link"),b=Object(n["E"])("LogOut"),v=Object(n["E"])("router-view");return Object(n["w"])(),Object(n["f"])("div",a,[Object(n["g"])("div",c,[this.$store.getters.isAuth&&this.$store.getters.hasDays?(Object(n["w"])(),Object(n["d"])(g,{key:0,"active-class":"active",class:"nav-link",to:"/"},{default:Object(n["L"])((function(){return[u]})),_:1})):Object(n["e"])("",!0),this.$store.getters.isAuth?(Object(n["w"])(),Object(n["d"])(g,{key:1,"active-class":"active",class:"nav-link",to:"/day"},{default:Object(n["L"])((function(){return[o]})),_:1})):Object(n["e"])("",!0),this.$store.getters.isAuth&&this.$store.getters.isAdmin?(Object(n["w"])(),Object(n["d"])(g,{key:2,"active-class":"active",class:"nav-link",to:"/users"},{default:Object(n["L"])((function(){return[s]})),_:1})):Object(n["e"])("",!0),this.$store.getters.isAuth?Object(n["e"])("",!0):(Object(n["w"])(),Object(n["d"])(g,{key:3,"active-class":"active",class:"nav-link",to:"/login"},{default:Object(n["L"])((function(){return[i]})),_:1})),this.$store.getters.isAuth?(Object(n["w"])(),Object(n["d"])(b,{key:4,onPushLogin:h.pushed},null,8,["onPushLogin"])):Object(n["e"])("",!0)]),l,h.isAuth?(Object(n["w"])(),Object(n["f"])("h5",d,"Приветствую, "+Object(n["G"])(h.fullname),1)):Object(n["e"])("",!0),p,Object(n["j"])(v)])}var f=r("1da1"),m=(r("96cf"),r("5502")),g=r("6c02");function b(e,t,r,a,c,u){return Object(n["w"])(),Object(n["f"])("div",null,[Object(n["g"])("button",{class:"btn btn-secondary mx-2 exit-button py-2",onClick:t[0]||(t[0]=function(){return a.logOut&&a.logOut.apply(a,arguments)})},"Выход")])}var v={props:[],emits:["push-login"],setup:function(e,t){var r=t.emit,n=Object(m["b"])(),a=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.dispatch("setDays",null);case 2:return e.next=4,n.dispatch("logOut");case 4:r("push-login");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{logOut:a}}},O=(r("890a"),r("6b0d")),k=r.n(O);const w=k()(v,[["render",b],["__scopeId","data-v-54261008"]]);var y=w,j={components:{LogOut:y},setup:function(){var e=Object(m["b"])(),t=Object(g["d"])(),r=Object(n["B"])(!1),a=Object(n["B"])(!1),c=Object(n["B"])(""),u=Object(n["B"])(!1);Object(n["r"])(Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.dispatch("onReload");case 2:r.value=e.getters.isAuth,a.value=e.getters.isAdmin,c.value=e.getters.fullname;case 5:case"end":return t.stop()}}),t)})))),r.value=e.getters.isAuth,a.value=e.getters.isAdmin,c.value=e.getters.fullname;var o=function(){t.push("/login"),e.commit("setDays",null)};return{isAdmin:a,fullname:c,isAuth:r,hasDaysOpened:u,pushed:o}}};r("5d25");const x=k()(j,[["render",h]]);var _=x,L=(r("d3b7"),r("3ca3"),r("ddb0"),[{path:"/",name:"Orders",meta:{requireAuth:!0,requireAdmin:!1},component:function(){return r.e("chunk-54d21914").then(r.bind(null,"159d"))}},{path:"/registration",name:"Registration",meta:{requireAuth:!1,requireAdmin:!1},component:function(){return r.e("chunk-2d0c5b16").then(r.bind(null,"3fd1"))}},{path:"/login",name:"Login",meta:{requireAuth:!1,requireAdmin:!1},component:function(){return r.e("chunk-2d2086b7").then(r.bind(null,"a55b"))}},{path:"/users",name:"Users",meta:{requireAuth:!0,requireAdmin:!0},component:function(){return r.e("chunk-d3f5a43c").then(r.bind(null,"ed81"))}},{path:"/day",name:"Day",meta:{requireAuth:!0,requireAdmin:!1},component:function(){return r.e("chunk-c462bbde").then(r.bind(null,"84f7"))}},{path:"/order/:id",name:"OrderId",meta:{requireAuth:!0,requireAdmin:!1},component:function(){return r.e("chunk-18c9904f").then(r.bind(null,"a5ee"))}}]),A=Object(g["a"])({history:Object(g["b"])("/"),routes:L}),R=A,T=r("bc3a"),E=r.n(T),S=(r("caad"),r("2532"),r("db49")),P={actions:{apiStatus:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.dispatch,!localStorage.token){e.next=17;break}return e.next=4,r("setToken",localStorage.token);case 4:return e.prev=4,e.next=7,E.a.get("".concat(S["server_api_auth"],"status/"));case 7:return n=e.sent,e.next=10,r("setUser",n.data);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](4),console.log(e.t0);case 15:e.next=21;break;case 17:return e.next=19,r("setUser",null);case 19:return e.next=21,r("setToken",null);case 21:case"end":return e.stop()}}),e,null,[[4,12]])})));function t(t){return e.apply(this,arguments)}return t}(),setToken:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,n("setToken",r);case 3:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}(),setUser:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,n("setUser",r);case 3:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}(),logIn:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,c,u,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.dispatch,e.prev=1,a=JSON.parse(r),c=a.username,u=a.password,e.next=5,E.a.post("".concat(S["server_api_auth"],"login/"),{username:c,password:u});case 5:return o=e.sent,e.next=8,n("setToken",o.data.token);case 8:return e.next=10,n("setUser",o.data.user);case 10:localStorage.token=o.data.token,E.a.defaults.headers.common["Authorization"]=localStorage.token,console.log("Logged in..."),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](1),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));function t(t,r){return e.apply(this,arguments)}return t}(),logOut:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.dispatch,localStorage.removeItem("token"),e.next=4,r("setDays",null);case 4:return e.next=6,r("setToken",null);case 6:return e.next=8,r("setUser",null);case 8:E.a.defaults.headers.common["Authorization"]=null,console.log("Logged out ...");case 10:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},mutations:{setToken:function(e,t){e.token=t},setUser:function(e,t){e.user=t}},getters:{token:function(e){return e.token},fullname:function(e){return e.user?e.user.fullname:""},username:function(e){return e.user?e.user.username:""},isAuth:function(e){return!!e.user},isAdmin:function(e){return!!e.user&&e.user.role.includes("ADMIN")}},state:{token:null,user:null}},q={actions:{setDays:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,e.prev=1,e.next=4,E.a.get("".concat(S["server_api_work"],"days/active"));case 4:return n=e.sent,e.t0=r,e.next=8,n.data;case 8:e.t1=e.sent,(0,e.t0)("setDays",e.t1),e.next=15;break;case 12:e.prev=12,e.t2=e["catch"](1),console.log(e.t2);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));function t(t){return e.apply(this,arguments)}return t}()},mutations:{setDays:function(e,t){e.days=t}},getters:{days:function(e){return e.days},hasDays:function(e){return!!e.days&&e.days.length},day_id:function(e){return e.days?e.days[0]._id:null}},state:{days:null}},D={actions:{setUserToManage:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,n("setUserToManage",r);case 3:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},mutations:{setUserToManage:function(e,t){return e.userToManage=t}},getters:{},state:{userToManage:null,loadedUsers:null}},U=(r("99af"),r("af81")),I={actions:{createNewOrder:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,c,u,o,s,i,l,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.dispatch,a=r.client_name,c=r.day_id,u=r.is_new,o=r.from_where,s="day_id=".concat(c),i="client_name=".concat(a),l="is_new=".concat(u),d="from_where=".concat(o),p="".concat(S["server_api_work"],"order/new?").concat(s,"&").concat(i,"&").concat(l,"&").concat(d),console.log(p),e.next=10,U["a"].post(p);case 10:return e.next=12,n("refreshOrderList");case 12:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}(),refreshOrderList:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,n=t.getters,a=n.day_id,console.log(a),e.next=5,U["a"].get("".concat(S["server_api_work"],"order/all?day_id=").concat(a));case 5:c=e.sent,r("setOrderList",c.data);case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),loadOrderToEditInStore:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,U["a"].get("".concat(S["server_api_work"],"order?id=").concat(r));case 3:a=e.sent,n("setOrderToEdit",a.data),console.log(a.data);case 6:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}(),closeOrder:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.dispatch,e.next=3,U["a"].patch("".concat(S["server_api_work"],"order/close/").concat(r));case 3:n("refreshOrderList");case 4:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},mutations:{setOrderList:function(e,t){return e.orders=t},setOrderToEdit:function(e,t){return e.orderToEdit=t}},getters:{orders:function(e){return e.orders},orderLength:function(e){return e.orders?e.orders.length:0},orderToEdit:function(e){return e.orderToEdit?e.orderToEdit:null},orderToEditId:function(e){return e.orderToEdit?e.orderToEdit._id:null}},state:{orders:null,orderToEdit:null}},M={actions:{addNewPurchaseToList:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.dispatch,e.next=3,U["a"].post("".concat(S["server_api_work"],"purchase/new"),r);case 3:return e.next=5,n("refreshValuesInPurchaseList");case 5:console.log(r);case 6:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}(),refreshValuesInPurchaseList:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.getters,n=t.commit,a=r.orderToEditId,e.next=4,U["a"].get("".concat(S["server_api_work"],"purchase/all?order_id=").concat(a));case 4:c=e.sent,console.log(c),n("updatePurchaseList",c.data);case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},mutations:{updatePurchaseList:function(e,t){e.purchaseList=t}},getters:{purchaseList:function(e){return e.purchaseList?e.purchaseList:null},purchaseListTotal:function(e){var t=0;if(e.purchaseList){for(var r=0;r<e.purchaseList.length;r++)t+=e.purchaseList[r].price_final;return t}return 0},purchaseListLength:function(e){return e.purchaseList?e.purchaseList.length:0}},state:{purchaseList:null}};E.a.defaults.headers.common["Authorization"]=localStorage.token;var N=Object(m["a"])({actions:{onReload:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.dispatch,e.next=3,r("apiStatus");case 3:return e.next=5,r("setDays");case 5:return e.next=7,r("refreshOrderList");case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},mutations:{},getters:{},state:{},modules:{user:D,auth:P,work:q,order:I,purchase:M}});Object(n["c"])(_).use(N).use(R).mount("#app")},"5d25":function(e,t,r){"use strict";r("8fd0")},"890a":function(e,t,r){"use strict";r("9dd7")},"8fd0":function(e,t,r){},"9dd7":function(e,t,r){},af81:function(e,t,r){"use strict";var n=r("bc3a"),a=r.n(n);a.a.defaults.headers.common["Authorization"]=localStorage.token,t["a"]=a.a},db49:function(e,t){e.exports={server_api_address:"http://localhost:5555/api/",server_api_auth:"http://localhost:5555/api/auth/",server_api_work:"http://localhost:5555/api/work/"}}});
//# sourceMappingURL=app.60dbbca4.js.map