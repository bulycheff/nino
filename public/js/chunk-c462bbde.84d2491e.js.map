{"version":3,"sources":["webpack:///./src/views/Day.vue","webpack:///./src/views/Day.vue?39db","webpack:///./src/utils/dateFormat.js"],"names":["store","daysData","days","hasOpenDays","dispatch","getters","value","length","openDay","axios","post","then","loaded","push","data","catch","err","console","log","closeDay","id","patch","commit","__exports__","dateFormat","format","options","includes","day","month","year","hour","minute","second","Intl","DateTimeFormat","Date"],"mappings":"6gBAsCA,IAAMA,EAAQ,iBACRC,EAAW,eAAS,CAAEC,KAAM,KAC5BC,EAAc,gBAAI,GAExB,eAAa,wCAAC,8GACNH,EAAMI,SAAS,WADT,OAEZH,EAASC,KAAOF,EAAMK,QAAQH,KAC9BC,EAAYG,QAAQL,EAASC,MAAOD,EAASC,KAAKK,OAAS,EAH/C,4CAMd,IAAMC,EAAU,WACdC,EAAA,KAAMC,KAAN,UAAe,qBAAf,eACGC,MAAK,SAAAC,GAEJX,EAASC,KAAKW,KAAKD,EAAOE,SAE3BC,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,OAGxBG,EAAW,SAAEC,GACjBX,EAAA,KAAMY,MAAN,UAAgB,qBAAhB,qBAA8CD,IAC3CT,MAAK,SAAAC,GAEJX,EAASC,KAAOU,EAAOE,KACvBd,EAAMsB,OAAO,UAAWV,EAAOE,SAEhCC,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,O,OAG9B,gBAAgB,WACdf,EAASC,KAAO,M,00BCjElB,MAAMqB,EAAc,EAEL,gB,wFCLA,SAASC,EAAYlB,GAAwB,IAAjBmB,EAAiB,uDAAR,OAE5CC,EAAU,GAqBhB,OAnBID,EAAOE,SAAS,UAClBD,EAAQE,IAAM,UACdF,EAAQG,MAAQ,UAChBH,EAAQI,KAAO,WAGbL,EAAOE,SAAS,UAClBD,EAAQK,KAAO,UACfL,EAAQM,OAAS,UACjBN,EAAQO,OAAS,WAGfR,EAAOE,SAAS,WAClBD,EAAQE,IAAM,UACdF,EAAQG,MAAQ,UAChBH,EAAQK,KAAO,UACfL,EAAQM,OAAS,WAGZ,IAAIE,KAAKC,eAAe,QAAST,GAASD,OAAO,IAAIW,KAAK9B","file":"js/chunk-c462bbde.84d2491e.js","sourcesContent":["<template>\n  <div class=\"day\">\n    <h5>Рабочая смена</h5>\n    <div v-if=\"!hasOpenDays\">\n      <button class=\"btn btn-primary\" type=\"button\" @click.prevent=\"openDay\">Открыть смену</button>\n    </div>\n  </div>\n\n  <table v-if=\"hasOpenDays\" class=\"table w-50\">\n    <thead>\n    <tr>\n      <th scope=\"col\">Открыта</th>\n      <th scope=\"col\">Действие</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr v-for=\"day in daysData.days\" :key=\"day._id\">\n      <td>{{ dateFormat(day.start, 'datetime') }}</td>\n      <td>\n        <button class=\"btn btn-danger\" type=\"button\" @click.prevent=\"closeDay(day._id)\">Закрыть смену</button>\n      </td>\n    </tr>\n    </tbody>\n  </table>\n\n</template>\n<script setup>\nimport axios from '../../axios'\nimport { server_api_work } from '../config'\nimport {\n  onBeforeMount,\n  onBeforeUnmount,\n  reactive,\n  ref\n} from 'vue'\nimport {useStore} from 'vuex'\nimport dateFormat from '../utils/dateFormat'\n\nconst store = useStore()\nconst daysData = reactive({ days: [] })\nconst hasOpenDays = ref(false)\n\nonBeforeMount(async() => {\n  await store.dispatch('setDays')\n  daysData.days = store.getters.days\n  hasOpenDays.value = daysData.days ? daysData.days.length > 0 : false\n})\n\nconst openDay = () => {\n  axios.post(`${ server_api_work }day/create`)\n    .then(loaded => {\n      // console.log(loaded.data)\n      daysData.days.push(loaded.data)\n    })\n    .catch(err => console.log(err))\n}\n\nconst closeDay = ( id ) => {\n  axios.patch(`${ server_api_work }day/close/${ id }`)\n    .then(loaded => {\n      // console.log(loaded.data)\n      daysData.days = loaded.data\n      store.commit('setDays', loaded.data)\n    })\n    .catch(err => console.log(err))\n}\n\nonBeforeUnmount(() => {\n  daysData.days = []\n})\n</script>\n","import script from \"./Day.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Day.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","export default function dateFormat (value, format = 'date') {\r\n  // console.log(value)\r\n  const options = {}\r\n\r\n  if (format.includes('date')) {\r\n    options.day = '2-digit'\r\n    options.month = '2-digit'\r\n    options.year = 'numeric'\r\n  }\r\n\r\n  if (format.includes('time')) {\r\n    options.hour = '2-digit'\r\n    options.minute = '2-digit'\r\n    options.second = '2-digit'\r\n  }\r\n\r\n  if (format.includes('short')) {\r\n    options.day = '2-digit'\r\n    options.month = '2-digit'\r\n    options.hour = '2-digit'\r\n    options.minute = '2-digit'\r\n  }\r\n\r\n  return new Intl.DateTimeFormat('ru-RU', options).format(new Date(value))\r\n}\r\n"],"sourceRoot":""}